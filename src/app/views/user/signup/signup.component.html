<app-header></app-header>

<br/>

<nz-card nzHoverable style="width:50%">
  <nz-card-meta nzTitle="User Registration" nzDescription="Please fill in the following fields" class="text-center" *ngIf="successfulSubmission">
  </nz-card-meta>

  <nz-card-meta nzTitle="Signup Success !" class="text-center" *ngIf="!successfulSubmission">
  </nz-card-meta>

  <!-- <br/>
  <nz-alert nzType="error" nzMessage={{errorMessage}} *ngIf="errorMessage" class="text-center"></nz-alert> -->
  
  <hr />
  
  <form nz-form [formGroup]="validateForm" (ngSubmit)="submitForm($event,validateForm.value)" *ngIf="successfulSubmission">
    
    <nz-form-item>
      <nz-form-label [nzSpan]="7" nzRequired>Username</nz-form-label>
      <nz-form-control [nzSpan]="12" nzHasFeedback>
        <input nz-input formControlName="username" placeholder="username">
        <nz-form-explain *ngIf="validateForm.get('username').dirty && validateForm.get('username').errors || validateForm.get('username').pending ">
          <ng-container *ngIf="validateForm.get('username').hasError('required')">
            Please input your username!
          </ng-container>
        </nz-form-explain>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="7" nzRequired>E-mail</nz-form-label>
      <nz-form-control [nzSpan]="12" nzHasFeedback>
        <input nz-input formControlName="email" placeholder="email" type="email" (change)="getUserMailId(validateForm.value)">
        <nz-form-explain *ngIf="validateForm.get('email').dirty&&validateForm.get('email').errors">
          <ng-container *ngIf="validateForm.get('email').hasError('email')">
            The input is not valid E-mail!
          </ng-container>
          <ng-container *ngIf="validateForm.get('email').hasError('required')">
            Please input your E-mail!
          </ng-container>
          <ng-container *ngIf="validateForm.get('email').hasError('duplicated')">
            E-mail already exists!
          </ng-container>
          <ng-container *ngIf="validateForm.get('email').pending">
            Validating...
          </ng-container>
        </nz-form-explain>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="7" nzRequired>Password</nz-form-label>
      <div>
        <nz-form-control [nzSpan]="12" nzHasFeedback>
          <input nz-input type="password" formControlName="password" (ngModelChange)="validateConfirmPassword()"
            placeholder="password">
          <nz-form-explain *ngIf="validateForm.get('password').dirty&&validateForm.get('password').hasError('required')">Please
            input your password!
          </nz-form-explain>
        </nz-form-control>
      </div>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="7" nzRequired>Confirm Password</nz-form-label>
      <nz-form-control [nzSpan]="12" nzHasFeedback>
        <input nz-input type="password" formControlName="confirm" placeholder="confirm your password">
        <nz-form-explain *ngIf="validateForm.get('confirm').dirty&&validateForm.get('confirm').errors">
          <ng-container *ngIf="validateForm.get('confirm').hasError('required')">
            Please confirm your password!
          </ng-container>
          <ng-container *ngIf="validateForm.get('confirm').hasError('confirm')">
            Password is inconsistent!
          </ng-container>
        </nz-form-explain>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="7" nzRequired>Your Role:</nz-form-label>
      <nz-form-control [nzSpan]="12" nzHasFeedback>
        <nz-select nzShowSearch nzPlaceHolder="Choose your role" formControlName="role" [(ngModel)]="defaultValue">
          <nz-option nzValue="buyer" nzLabel="Buyer"></nz-option>
          <nz-option nzValue="seller" nzLabel="Seller"></nz-option>
          <nz-option nzValue="handler" nzLabel="Handler"></nz-option>
          <nz-option nzValue="admin" nzLabel="Admin" nzDisabled></nz-option>
        </nz-select>
        <nz-form-explain *ngIf="validateForm.get('role').dirty&&validateForm.get('role').errors">
          <ng-container *ngIf="validateForm.get('role').hasError('required')">
            Please choose you role
          </ng-container>
        </nz-form-explain>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-label [nzSpan]="7">Say about yourself</nz-form-label>
      <nz-form-control [nzSpan]="12">
        <textarea formControlName="comment" nz-input rows="4" placeholder="Optional: Say your part in this blockchain network. &#10;Ex: Buyer|Seller">
        </textarea>
        <!-- <nz-form-explain *ngIf="validateForm.get('comment').dirty&&validateForm.get('comment').hasError('required')">Please
          write something here!</nz-form-explain> -->
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-control [nzOffset]="7" [nzSpan]="12">
        <button nz-button nzType="primary" [disabled]="!validateForm.valid">Submit</button>
        &nbsp;&nbsp;
        <button nz-button (click)="resetForm($event)">Reset</button>
      </nz-form-control>
    </nz-form-item>
  </form>

  <hr/>
  <div class="alert alert-success text-center" *ngIf="successMessage">    
    Signup Successful ! login to continue
  </div>
  <div class="alert alert-danger text-center" *ngIf="errorOccurred">{{errorMessage}}</div>

</nz-card>

<!-- <ng-template #registerTemplate>
  <img alt="register" src="assets/images/user-auth/form-cover.jpg" />
</ng-template> -->